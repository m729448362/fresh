<!DOCTYPE HTML>
<html>
<head>
<title></title>
<link href="index.css" rel="stylesheet" type="text/css" media="all" />
<link href="css/pintuer.css" rel="stylesheet" type="text/css" media="all" />
<link href="css/admin.css" rel="stylesheet" type="text/css" media="all" />

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<!-- -->
<script src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery.cookie.js"></script>
<script type="text/javascript" src="js/JquerySession.js"></script>
<script type="text/javascript">
	var obj = sessionStorage.getItem('user');//{"userName":"Mr wang","userType":1}
	var user =JSON.parse(obj);//user对象 
	$(document).ready(function(c) {
		$.ajax({//查询商品种类
	             url: "/fresh/goods_type/showAllType.action",        //后台url
	             data: {                          //数据
	                  goodsType:""
	             },
	             type: "POST",                   //类型，POST或者GET
	             dataType: 'json',              //数据返回类型，可以是xml、json等
	             success: function (data) {      //成功，回调函数    画页面
	                 	$("#goodsType").remove();//移除
	                 	$("#title").append("<ul id='goodsType'></ul>");
	                  for(var i=0;i<data.length;i++){//data.length是获取data的长度。for循环
                          $("#goodsType").append("<li style='float:left;padding:0.2em;'><a href='javascript:void(0)' onclick='getGoods(\"+data[i].type+\")'>"+data[i].name+"</a></li>");
                     }
	                 $("#goodsType").append("<li style='float:left;padding:0.2em;'><a onclick='javascript:getGoods(\"other\")'>其他</a></li>");
	                 getGoods("1");//查询所有种类商品
	             },
	             error: function (er) {          //失败，回调函数
	                 alert(er);
	             }
	         });
	});
	function getGoods(goodsType){//根据种类查询商品
	   $.ajax({
             url: "/fresh/goods/getGoodsByType.action",        //后台url
             data: {                          //数据
                 goodsType:goodsType
             },
             type: "POST",                   //类型，POST或者GET
             dataType: 'json',              //数据返回类型，可以是xml、json等
             success: function (data) {      //成功，回调函数    画页面
                 	$("#goods").remove();//移除
                 	$("#goodsType").append("<table class='table table-hover text-center' id='goods'></table>");
                  for(var i=0;i<data.length;i++){//data.length是获取data的长度。for循环
                        $("#goods").append("<tr><td rowspan='2'><img src="+data[i].img+"></td><td colspan='3'><a href='javascript:openPage("+data[i].id+")'>"+data[i].name+"</a></td></tr>+<tr><td><input type='button' value='基地严选'/></td><td>+data[i].price+</td><td><input type='button' value='加入菜篮' onclick='addToMyBasket('"+data[i].goodsId+"')'></input></td></tr>");
                        //如果添加class或者id内容要加单引号例如：$("#first").append("<li class='a'>"+data[i].name+"</li>");
                    }
             },
             error: function (er) {          //失败，回调函数
                 alert(er);
             }
         });
	}
	function addToMyBasket(goodsId){//加入菜篮 
	
     	var data={
                "goodsId":goodsId,
                "amount":1
    		};
		$.ajax({//
             url: "/fresh/goods/addGoods.action",        //后台url
            JSON.stringify(data),
             type: "POST",                   //类型，POST或者GET
             dataType: 'json',              //数据返回类型，可以是xml、json等
             contentType:'application/json;charset=UTF-8',
             success: function (data) {      //成功，回调函数    画页面
                   },
             error: function (er) {          //失败，回调函数
                 alert(er);
             }
         });
	}
	function openPage(obj){//订单详情
		window.sessionStorage.setItem('goodsId', obj);
	    window.location.href="./goodsDetail.html"; 
	}
	
</script>
</head>
<body>
<form method="post" action="" id="listform">
  <div class="panel admin-panel">
  	<header class="panel-head" ><strong> 商品列表-全部</strong></header> 
  	<table id="title">
  		<tr><td>
  			<div class="title">
		    	<ul >
			    	<li style="float:left;padding:0.2em;"><a href="./index.html">返回首页</a></li>
			    	<li style="float:left;padding:0.2em;"><a href="./register.html">我的菜篮</a></li>
		    	</ul>
		    </div>
  		</td></th>
  	</table>
   	<ul id="goodsType">
   		<li style="float:left;padding:0.2em;"><a onclick="javascript:getGoods()">全部</a></li>
   		<li style="float:left;padding:0.2em;"><a>叶菜类</a></li>
   		<li style="float:left;padding:0.2em;"><a>根茎类</a></li>
   		<li style="float:left;padding:0.2em;"><a>瓜果类</a></li>
   		<li style="float:left;padding:0.2em;"><a>豆类</a></li>
   		<li style="float:left;padding:0.2em;"><a>其他</a></li>
   	</ul>
    <table class="table table-hover text-center" id="goods">
      <tr>
        <td rowspan="2"><img src="./images/vegetable1.jpg"></td>
        <td colspan="3"><a href="javascript:openPage('goodsId')">蔬菜名称</a></td>
      </tr>
     <!--  <volist name="list" id="vo"> -->
        <tr>
          <td><input type="button" value="基地严选"/></td>
          <td>蔬菜价格</td>
          <td><input type="button" value="加入菜篮" onclick="addToMyBasket(goodsId)"/></td>
        </tr>
    </table>
  </div>
</form>
<script type="text/javascript">


</script>
</body>
</html>